<!DOCTYPE html>
<html>
<head>
  <title>fusemap-occupancy</title>

  <link rel='stylesheet' href='./css/style.css'>

  <script src='./bower_components/d3/d3.min.js'></script>
</head>
<body>
<div>
  <a href='./'>home</a>
</div>
<div class="canvas-wrapper">
  <canvas id='floorCanvasView'></canvas>
</div>

<script src='./js/app.js'></script>
<script src='./js/occupancy.js'></script>

<script>
  var occupancy = new Occupancy();

  d3.json('data/occupancy/occupancy.json', function(data) {
    var formatedData = FormatJsonForOccupancy(data);

    occupancy.FloorCanvasID('floorCanvasView');
    occupancy.ColorRange(['#008000', '#FFF200', '#FF0000']);
    occupancy.HeatmapType(HEATMAP_PERCENT); // HEATMAP_PERCENT HEATMAP_OCC_STATE
    occupancy.TimelineType(TIMELINE_PERCENT); // TIMELINE_PERCENT TIMELINE_HOUR
    occupancy.Dataset(formatedData);
    occupancy.LegendTitle('Power Usage');

    occupancy.Init(timelineChangedCallback);
  });

  function timelineChangedCallback(value) {
    console.log('callback : ', d3.timeFormat('%H:%M')(value));

    d3.json('data/occupancy/occupancy2.json', function(data) {
      var formatedData = FormatJsonForOccupancy(data);
      occupancy.Dataset(formatedData);
      occupancy.ReDraw(timelineChangedCallback);
    });
  }
</script>
</body>
</html>